"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t="object"==typeof process&&"object"==typeof process.env&&"production"!==process.env.NODE_ENV,e=(t,e)=>{console.error("[VueRouteProps warn]: ",t,e)},o=t=>({}.toString.call(t)),r=(t,e)=>t.hasOwnProperty(e),n=[null,Boolean,String,Number,Array,Object];function u(){}function i(){return!0}function s(n,u){return{beforeCreate(){if(void 0!==this.$options.routeProps){(u=function({options:o={inspect:!1,debug:!1},context:r}){"[object Object]"!=={}.toString.call(o)&&e(`Options: ${o} should be an object`,r);void 0===o.inspect&&(o.inspect=!1);void 0===o.debug&&(o.debug=t);return o}({options:u,context:this})).debug&&(function({context:t}){void 0===t.$router&&e("Missing vue-router",t)}({context:this}),function({routeProps:t,context:e}){let r=!0;if("[object Object]"===o(t))for(const n in t)"[object Object]"===o(t[n])&&(r=r&&c({routeProps:t,prop:n,context:e})&&p({routeProps:t,prop:n,context:e}))}({routeProps:this.$options.routeProps,context:this})),this._routeProps={normalized:a({routeProps:this.$options.routeProps}),computed:{}};for(const t in this._routeProps.normalized)this._routeProps.computed[t]=void 0,n.util.defineReactive(this._routeProps.computed,t),P({vm:this,routeProp:t})}},watch:{$route:{immediate:!0,handler(){if(void 0===this.$options.routeProps)return;u.debug&&function({normalizedRouteProps:t,context:e}){let o=!0;for(const r in t)o=o&&l({normalizedRouteProps:t,prop:r,context:e})&&d({normalizedRouteProps:t,prop:r,context:e})&&f({normalizedRouteProps:t,prop:r,context:e})}({normalizedRouteProps:this._routeProps.normalized,context:this});const t=function({normalizedRouteProps:t,route:e,context:o}){const n={};for(const o in t)n[o]=r(e.query,o)?JSON.parse(e.query[o]):t[o].default();return n}({normalizedRouteProps:this._routeProps.normalized,route:this.$route,context:this});for(const e in t)this._routeProps.computed[e]=t[e];var e,o;u.inspect&&(e=JSON.stringify(this._routeProps.computed,null,2),o=this,console.log("[VueRouteProps log]: ",e,o))}}}}}function c({routeProps:t,prop:r,context:n}){return"[object Object]"!==o(t[r].default)&&"[object Array]"!==o(t[r].default)||(e(`Invalid default value for routeProp "${r}": routeProps with type Object/Array must use a factory function to return the default value.`,n),!1)}function p({routeProps:t,prop:n,context:u}){let i=!0;return"[object Function]"===o(t[n].validator)&&r(t[n],"default")&&(i="[object Function]"===o(t[n].default)?t[n].validator(t[n].default()):t[n].validator(t[n].default)),!1===i&&e(`Invalid routeProp: custom validator check failed for routeProp "${n}".`,u),i}function a({routeProps:t}){if("[object Array]"===o(t)){const e={};for(const o of t)e[o]={};t=e}for(const e in t)"[object Array]"===o(t[e])?t[e]={type:t[e]}:"[object Object]"!==o(t[e])&&(t[e]={type:[t[e]]});for(const e in t){if(!1===r(t[e],"required")&&(t[e].required=!1),!1===r(t[e],"type")?t[e].type=n:"[object Array]"!==o(t[e].type)?t[e].type=[t[e].type]:0===t[e].type.length&&(t[e].type=n),!1===r(t[e],"default"))t[e].default=u;else if("[object Function]"!==o(t[e].default)){const o=t[e].default;t[e].default=function(){return o}}!1===r(t[e],"validator")&&(t[e].validator=i)}return t}function l({normalizedRouteProps:t,prop:o,context:n}){const u=r(n.$route.query,o)?JSON.parse(n.$route.query[o]):void 0;return!t[o].required||void 0!==u||(e(`Missing required routeProp: "${o}"`,n),!1)}function d({normalizedRouteProps:t,prop:n,context:u}){const i=r(u.$route.query,n)?JSON.parse(u.$route.query[n]):t[n].default();let s=!0;if(void 0===i?!0===t[n].required&&(s=!1):null===i?!1===t[n].type.includes(null)&&(s=!1):!1===t[n].type.includes(Object.getPrototypeOf(i).constructor)&&(s=!1),!1===s){const r=[];for(const e of t[n].type)null===e?r.push("null"):r.push(/function ([^(]+)/.exec(e.toString())[1]);const s=o(i).slice(8,-1);e(`Invalid routeProp: type check failed for routeProp "${n}". Expected ${r.join(", ")}, got ${s} with value ${JSON.stringify(i)}.`,u)}return s}function f({normalizedRouteProps:t,prop:o,context:n}){const u=r(n.$route.query,o)?JSON.parse(n.$route.query[o]):t[o].default();return!((t[o].required||r(n.$route.query,o))&&!t[o].validator(u,o))||(e(`Invalid routeProp: custom validator check failed for routeProp "${o}".`,n),!1)}function P({vm:t,routeProp:o}){Object.defineProperty(t,o,{configurable:!0,enumerable:!0,set(){e(`Avoid mutating a routeProp directly since the value will be overwritten whenever the route changes. Instead, use a data or computed property based on the routeProp's value. Prop being mutated: "${o}"`,t)},get:()=>t._routeProps.computed[o]})}exports.install=function(t,e={debug:"development"===process.env.NODE_ENV||"test"===process.env.NODE_ENV,inspect:!1}){t.mixin(s(t,e))};
