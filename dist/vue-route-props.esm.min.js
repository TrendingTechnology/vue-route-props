import t from"vue";const o="object"==typeof process&&"object"==typeof process.env&&"production"!==process.env.NODE_ENV,e=(t,o)=>{console.error("[VueRouteProps warn]: ",t,o)},r=t=>({}.toString.call(t)),u=(t,o)=>t.hasOwnProperty(o),n=[null,Boolean,String,Number,Array,Object];function i(){}function c(){return!0}function p(){return{beforeCreate(){if(void 0!==this.$options.routeProps){o&&function({routeProps:t,context:o}){let e=!0;if("[object Object]"===r(t))for(const u in t)"[object Object]"===r(t[u])&&(e=e&&s({routeProps:t,prop:u,context:o})&&a({routeProps:t,prop:u,context:o}))}({routeProps:this.$options.routeProps,context:this}),this._routeProps={normalized:l({routeProps:this.$options.routeProps}),computed:{}};for(const o in this._routeProps.normalized)this._routeProps.computed[o]=void 0,t.util.defineReactive(this._routeProps.computed,o),y({vm:this,routeProp:o})}},watch:{$route:{immediate:!0,handler(){if(void 0===this.$options.routeProps)return;o&&function({normalizedRouteProps:t,context:o}){let e=!0;for(const r in t)e=e&&d({normalizedRouteProps:t,prop:r,context:o})&&f({normalizedRouteProps:t,prop:r,context:o})&&P({normalizedRouteProps:t,prop:r,context:o})}({normalizedRouteProps:this._routeProps.normalized,context:this});const t=function({normalizedRouteProps:t,route:o,context:e}){const r={};for(const e in t)r[e]=u(o.query,e)?JSON.parse(o.query[e]):t[e].default();return r}({normalizedRouteProps:this._routeProps.normalized,route:this.$route,context:this});for(const o in t)this._routeProps.computed[o]=t[o]}}}}}function s({routeProps:t,prop:o,context:u}){return"[object Object]"!==r(t[o].default)&&"[object Array]"!==r(t[o].default)||(e(`Invalid default value for routeProp "${o}": routeProps with type Object/Array must use a factory function to return the default value.`,u),!1)}function a({routeProps:t,prop:o,context:n}){let i=!0;return"[object Function]"===r(t[o].validator)&&u(t[o],"default")&&(i="[object Function]"===r(t[o].default)?t[o].validator(t[o].default()):t[o].validator(t[o].default)),!1===i&&e(`Invalid routeProp: custom validator check failed for routeProp "${o}".`,n),i}function l({routeProps:t}){if("[object Array]"===r(t)){const o={};for(const e of t)o[e]={};t=o}for(const o in t)"[object Array]"===r(t[o])?t[o]={type:t[o]}:"[object Object]"!==r(t[o])&&(t[o]={type:[t[o]]});for(const o in t){if(!1===u(t[o],"required")&&(t[o].required=!1),!1===u(t[o],"type")?t[o].type=n:"[object Array]"!==r(t[o].type)?t[o].type=[t[o].type]:0===t[o].type.length&&(t[o].type=n),!1===u(t[o],"default"))t[o].default=i;else if("[object Function]"!==r(t[o].default)){const e=t[o].default;t[o].default=function(){return e}}!1===u(t[o],"validator")&&(t[o].validator=c)}return t}function d({normalizedRouteProps:t,prop:o,context:r}){const n=u(r.$route.query,o)?JSON.parse(r.$route.query[o]):void 0;return!t[o].required||void 0!==n||(e(`Missing required routeProp: "${o}"`,r),!1)}function f({normalizedRouteProps:t,prop:o,context:n}){const i=u(n.$route.query,o)?JSON.parse(n.$route.query[o]):t[o].default();let c=!0;if(void 0===i?!0===t[o].required&&(c=!1):null===i?!1===t[o].type.includes(null)&&(c=!1):!1===t[o].type.includes(Object.getPrototypeOf(i).constructor)&&(c=!1),!1===c){const u=[];for(const e of t[o].type)null===e?u.push("null"):u.push(/function ([^(]+)/.exec(e.toString())[1]);const c=r(i).slice(8,-1);e(`Invalid routeProp: type check failed for routeProp "${o}". Expected ${u.join(", ")}, got ${c} with value ${JSON.stringify(i)}.`,n)}return c}function P({normalizedRouteProps:t,prop:o,context:r}){const n=u(r.$route.query,o)?JSON.parse(r.$route.query[o]):t[o].default();return!((t[o].required||u(r.$route.query,o))&&!t[o].validator(n,o))||(e(`Invalid routeProp: custom validator check failed for routeProp "${o}".`,r),!1)}function y({vm:t,routeProp:o}){Object.defineProperty(t,o,{configurable:!0,enumerable:!0,set(){e("Avoid mutating a routeProp directly since the value will be overwritten whenever the route changes. Instead, use a data or computed property based on the routeProp's "+`value. Prop being mutated: "${o}"`,t)},get:()=>t._routeProps.computed[o]})}var m={install:function(t){t.mixin(p())}};export default m;
